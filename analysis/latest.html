<!doctype html>
<meta charset="utf-8">
<title>Latest Analysis</title>
<style>
  html,body{margin:0;height:100%}
  body{font-family:sans-serif;display:grid;grid-template-rows:1fr auto;align-items:center;justify-items:center;padding:8px}
  img{width:256px;height:256px;border:1px solid #ddd;display:block}
  a{font-size:12px;text-decoration:none}
</style>
<img id="cmp" alt="compare grid 256x256">
<a id="lnk" target="_blank" rel="noopener">Bekijk alle analyse-bestanden â†—</a>
<script>
  const segs = location.pathname.split("/").filter(Boolean);
  const base = (segs.length? "/" + segs[0] + "/" : "/");

  const cmp = document.getElementById('cmp');
  const lnk = document.getElementById('lnk');
  lnk.href = "https://github.com/bramdhontsr/ame-rasp-poe/tree/main/analysis/out";

  let last = null;
  async function refreshOnce(stamp){
    const v = stamp || Date.now();
    cmp.src = base + "analysis/out/compare-grid.png?_=" + v;
  }
  async function poll(){
    try{
      const m = await fetch(base + "analysis/out/marker.json?_=" + Date.now()).then(r=>r.json());
      const s = m.updated_at || Date.now().toString();
      if (s !== last){ last = s; await refreshOnce(encodeURIComponent(s)); }
    }catch(e){}
  }
  refreshOnce(); poll(); setInterval(poll, 15000);
</script>
