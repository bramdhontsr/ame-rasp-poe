<!doctype html>
<meta charset="utf-8">
<title>AME Piece Viewer</title>
<style>
  html,body{margin:0;height:100%}
  body{display:flex;align-items:center;justify-content:center}
  .box{width:256px;height:256px;display:flex;align-items:center;justify-content:center}
  img,iframe{width:256px;height:256px;border:0;display:block}
</style>
<div class="box" id="box"></div>
<script>
  // Gebruik: piece.html?img=/ame-rasp-poe/gallery/NAAM.webp
  // of:      piece.html?n=42&L=8  (rendert via widgets/image.html)
  const u = new URL(location.href);
  const box = document.getElementById('box');
  const imgSrc = u.searchParams.get('img');

  if (imgSrc) {
    const img = new Image();
    img.decoding = "async";
    img.loading = "eager";
    img.src = imgSrc;
    box.appendChild(img);
  } else {
    // fallback naar code-render: widgets/image.html
    const n = u.searchParams.get('n') ?? '42';
    const L = u.searchParams.get('L') ?? '8';
    const v = Date.now();
    const f = document.createElement('iframe');
    f.src = `https://bramdhontsr.github.io/ame-rasp-poe/widgets/image.html?n=${encodeURIComponent(n)}&L=${encodeURIComponent(L)}&v=${v}`;
    box.appendChild(f);
  }
</script>
